identity_and_access:
  documentation_links:
  - https://help.sap.com/docs/SAP_S4HANA_ON-PREMISE/22bbe89ef68b4d0e98d05f0d56a7f6c8/c711a753b9cfdb72e10000000a4450e5.html
  - https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-sap/user-management-in-a-nutshell-for-the-sap-s-4hana-cloud-public-edition/ba-p/13556782
  - https://www.youtube.com/watch?v=a1ENk6h1AXg
  - https://community.sap.com/t5/technology-blog-posts-by-sap/a-single-sign-on-guide-for-sap-s-4hana-cloud-private-edition-rise-with-sap/ba-p/13527696
  lifecycle_options:
  - Creation
  - Management
  - Restriction
  - Termination of access
  - New
  - Active
  - Inactive
  - Locked
  - Unlocked
  rbac_api_assignment:
    reference: https://www.youtube.com/watch?v=QUS-vsdqZxQ
    value: yes - Roles can be assigned to business users through automated integration
      (e.g., with SuccessFactors, Workday), batch uploads, and mass change transactions
      like SU10.
  rbac_support:
    reference: hallucinated link doublecheck content
    value: yes - Supports assignment of business roles, which contain business catalogs
      and applications. Roles can have data restrictions.
  scim_authentication_acquisition_steps:
    reference: https://help.sap.com/docs/SAP_IDENTITY_MANAGEMENT/4773a9ae1296411a9d5c24873a8d418c/e51d455bd89f407a84089a1d7a65f512.html
    value: uncertain
  scim_authentication_mechanisms:
    reference: https://help.sap.com/docs/SAP_IDENTITY_MANAGEMENT/4773a9ae1296411a9d5c24873a8d418c/e51d455bd89f407a84089a1d7a65f512.html
    value: uncertain
  scim_licensing_level_requirement:
    reference: hallucinated link doublecheck content
    value: uncertain
  scim_support:
    reference: https://help.sap.com/docs/SAP_IDENTITY_MANAGEMENT/4773a9ae1296411a9d5c24873a8d418c/e51d455bd89f407a84089a1d7a65f512.html
    value: uncertain
  seat_costs:
  - archived:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
    license_level: Professional User
    suspended_disabled:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
  - archived:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
    license_level: Functional User (Limited Professional)
    suspended_disabled:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
  - archived:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
    license_level: Productivity User
    suspended_disabled:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
  - archived:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
    license_level: Developer User
    suspended_disabled:
      reference: hallucinated link doublecheck content
      value: uncertain
  - archived:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
    license_level: Employee Self-Service
    suspended_disabled:
      reference: https://vertexaisearch.cloud.google.com/grounding-api-redirect/AUZIYQG7KgMt2gA4dCUXUPsmOwv7hno84ArpJlpStSsSBgpN12nISKF7srGUHvbTE7_GEJi-HInN_Vpy3TN1dA6wkoFvEPiEhx1_HHNYSJndykydpa8eImKCnAuwzuuSeIM_U2t7tJpLEAH8aZi_FuLA1SKiiLAk-4mZ0buU05-FhOlB
      value: uncertain
  sso_license_level_requirement:
    reference: hallucinated link doublecheck content
    value: uncertain
  sso_support:
    reference: https://xiting.com/en/secure-authentication-and-sso-for-sap/
    value: yes - SAML 2.0, SPNEGO (Kerberos), X.509 client certificates, and logon
      tickets for web-based applications (SAP Fiori) and SAP GUI. Integration with
      existing IDPs like Azure or Okta through SAP Cloud Identity Services.
  user_management_api_authentication_acquisition_steps:
    reference: https://m.youtube.com/watch?v=QUS-vsdqZxQ
    value: For direct user creation, an administrator logs in with appropriate permissions
      (e.g., via SU01). For mass changes, transaction SU10 allows entering user names
      and performing bulk operations, including setting initial passwords for new
      users or changing existing user attributes. For SAP Cloud Identity Services,
      users can be created directly within the IAS tenant.
  user_management_api_authentication_mechanisms:
    reference: https://www.youtube.com/watch?v=QUS-vsdqZxQ
    value: The main user record is stored in Gateway in SU01 with an active password
      for Gateway OData Services. For SAP Cloud Identity Services, users can be created
      in IAS and authenticate directly there or via integrated IDPs.
  user_management_api_licensing_level:
    reference: https://www.beonesolutions.com/blog/sap-s-4hana-public-cloud-licensing-options/
    value: uncertain
  user_management_api_support:
    reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-sap/user-management-in-a-nutshell-for-the-sap-s-4hana-cloud-public-edition/ba-p/13556782
    value: yes - User creation, update, and deletion are supported via Gateway OData
      Services. Mass user changes can be performed using transaction SU10. SAP Identity
      Management (IdM) and SAP Identity Provisioning Service (IPS) are used for provisioning.
security_monitoring:
  documentation_links:
  - https://help.sap.com/docs/SAP_S4HANA_CLOUD/55a7cb346519450cb9e6d21c1ecd6ec1/005f91d089c74382ac3645628c70bede.html
  - https://help.sap.com/docs/SAP_S4HANA_CLOUD/55a7cb346519450cb9e6d21c1ecd6ec1/8c170f837c5f4783947d7db0ebc4fca6.html
  - https://help.sap.com/docs/SAP_S4HANA_CLOUD/55a7cb346519450cb9e6d21c1ecd6ec1/ebbbc901f3b6411c8c2ed87e7a4ed71d.html
  - https://learn.microsoft.com/en-us/azure/sentinel/sap/deployment-overview
  event_logs:
    api_call:
      reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-sap/the-sal-api-for-sap-s-4hana-cloud-and-how-you-can-use-it/ba-p/13500988
      value: API calls to SAP S/4HANA's business and administrative APIs can generate
        security-relevant events that are captured in the Security Audit Log. The
        Security Audit Log API allows retrieval of this data in JSON format for SIEM
        integration. This API is available for SAP S/4HANA Cloud Public Edition.
    configuration_change:
      reference: https://help.sap.com/docs/SAP_S4HANA_CLOUD/55a7cb346519450cb9e6d21c1ecd6ec1/005f91d089c74382ac3645628c70bede.html
      value: Configuration changes can be tracked through Change Documents, which
        provide a history of modifications to various objects. The Security Audit
        Log also records security-relevant events on a technical level, which would
        include changes to security configurations.
    data_export:
      reference: https://blog.sap-press.com/why-you-need-to-use-logs-to-secure-your-sap-s4hana-system
      value: Read Access Logs (RAL) in SAP S/4HANA can provide a history of access
        to particularly sensitive data, which would include data export actions if
        configured by the customer. Microsoft Sentinel's solution for SAP applications
        supports threat detections related to data exfiltration, such as multiple
        file downloads. UI data protection logging can also assist with monitoring
        data access.
    role_assignment:
      reference: https://help.sap.com/docs/SAP_NETWEAVER_750/70579122359e4b6c810620025f171520/4b6279f01e230302e10000000a155106.html
      value: Change documents are maintained for objects like business users, providing
        a change history. This would include changes related to role assignments.
        Additionally, the security audit log for SAP NetWeaver AS Java logs changes
        to users, roles, and groups.
    security_policy_change:
      reference: hallucinated link doublecheck content
      value: Microsoft Sentinel's solution for SAP applications includes threat detections
        for attempts to bypass SAP security mechanisms, such as disabling audit logging.
        This indicates that security policy changes, specifically disabling audit
        logging, are detectable.
    user_account_creation:
      reference: https://help.sap.com/docs/SAP_NETWEAVER_750/70579122359e4b6c810620025f171520/4b6279f01e230302e10000000a155106.html
      value: The security audit log in SAP NetWeaver AS Java logs user creation. Change
        documents are maintained for business users and provide a change history,
        which would encompass user account creation.
    user_login:
      reference: https://help.powerconnect.io/powerconnectdocumentation/sap-s-4-hana-cloud-public-edition-audit-logs
      value: User login activities are captured in the Security Audit Logs (SAL) of
        SAP S/4HANA. These logs include details such as event ID (e.g., 'AU1' for
        logon), timestamp, terminal name or IP address, and user identifiers like
        full name, user ID, alias, and email. Both successful and failed login attempts
        are recorded. Additional logs related to SAP Cloud Identity Services - Identity
        Authentication can also be accessed for correlation.
  event_logs_licensing_level:
    reference: hallucinated link doublecheck content
    value: To access security audit logs in SAP S/4HANA Cloud Public Edition, a business
      role containing the business catalog 'Security - Security Audit Log' (SAP_CORE_BC_SEC_SAL)
      is required. General user licenses for SAP S/4HANA are based on different user
      types (Productivity, Functional, Professional, Developer) and a 'Digital Access'
      model for indirect usage, but no specific licensing level is stated as directly
      tied to the access of security audit logs themselves.
  ingestion_methods:
  - reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-sap/the-sal-api-for-sap-s-4hana-cloud-and-how-you-can-use-it/ba-p/13500988
    value: SAP S/4HANA Cloud Public Edition offers a Security Audit Log API (REST
      API, JSON format) to retrieve security audit log data for SIEM integration.
      This API requires a configured communication arrangement for communication scenario
      SAP_COM_0750.
  - reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/microsoft-sentinel-for-sap-goes-agentless/ba-p/13960238
    value: SIEM vendors provide agentless data connectors (e.g., Microsoft Sentinel)
      or add-ons (e.g., PowerConnect for Splunk) that leverage SAP Cloud Connector
      and SAP Integration Suite or internal SAP add-ons to collect logs from SAP systems
      and send them to the SIEM. These can use HTTPS for secure transmission.
  - reference: https://www.layersevensecurity.com/whitepaper-siem-integration-for-sap/
    value: SAP Solution Manager can write alerts derived from event logs to text files
      in real-time. These files can then be ingested by SIEM platforms. This approach
      allows for log filtering, normalization, and enrichment before ingestion.
  log_export_options:
    tools_connectors:
      reference: hallucinated link doublecheck content
      value: Log export from SAP S/4HANA for SIEM integration is primarily facilitated
        through APIs, specifically the Security Audit Log API (REST API, JSON format),
        which requires a communication arrangement (SAP_COM_0750). SIEM-specific connectors
        or add-ons (like Microsoft Sentinel's agentless connector or PowerConnect
        for Splunk) handle the collection and transmission of logs. SAP Solution Manager
        can also export alerts to text files for ingestion by SIEMs.
  monitoring_products:
  - reference: https://securiment.com/article/How-to-Integrate-SAP-with-Microsoft-Sentinel-
    value: Microsoft Sentinel offers a solution for SAP applications, including an
      agentless data connector compatible with SAP S/4HANA Cloud, Private Edition
      RISE with SAP, and S/4HANA on-premises. It ingests critical security logs and
      provides out-of-the-box security content for threat detection, workbooks, and
      playbooks.
  - reference: https://www.youtube.com/supported_browsers?next_url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DT5nR-CkbqPc
    value: Splunk integrates with SAP S/4HANA for enhanced operational efficiency
      through real-time monitoring and alerting. Splunk's analytics capabilities process
      data from SAP to identify patterns and anomalies. Solutions like PowerConnect
      for Splunk are specifically designed to collect SAP security logs, performance
      metrics, and business data into Splunk, offering pre-built dashboards.
  - reference: https://community.sap.com/t5/technology-blog-posts-by-members/sap-enterprise-threat-detection-integrated-into-ibm-qradar/ba-p/13351922
    value: IBM QRadar can integrate with SAP S/4HANA, often leveraging third-party
      products like SecurityBridge or integrating with SAP Enterprise Threat Detection
      (ETD). SecurityBridge provides an adapter for IBM QRadar to connect via RESTful
      APIs and a custom Device Support Module (DSM). SAP ETD collects and analyzes
      SAP log data in real-time, sending alerts to QRadar.
  - reference: https://www.layersevensecurity.com/siem-integration-for-sap/
    value: Layer Seven Security provides a 'SIEM Integrator for SAP', a software add-on
      for SAP Solution Manager. It offers automated threat detection for SAP systems
      and supports integration with various SIEM platforms including Splunk, QRadar,
      ArcSight, LogRhythm, and SolarWinds. This integrator includes over 300 attack
      detection patterns.
incident_response:
  documentation_links:
  - https://securitybridge.com/solutions/incident-management-and-response/
  - https://api.sap.com/api/CE_CHGRECORDUSERSTATUS_0001/overview
  - https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/configuring-the-automatic-sign-out-in-s-4hana-cloud/ba-p/12847077
  - https://layersevensecurity.com/siem-integration-for-sap/
  - https://community.sap.com/t5/technology-blog-posts-by-sap/rise-with-sap-comparing-the-security-of-sap-s-4hana-cloud-private-edition/ba-p/13568823
  - https://sourceforge.net/software/incident-response/integrates-with-sap-s-4hana/
  invalidate_sessions_api:
    reference: https://securitybridge.com/solutions/incident-management-and-response/
    value: Automated responses can include terminating a malicious session through
      SOAR integrations. While a specific API for invalidating individual sessions
      was not explicitly detailed, session timeout configurations are available. SAP
      Fiori launchpad sessions can be managed with server-driven or UI-driven sign-out
      parameters, such as `SESSION_TIMEOUT_INTERVAL_IN_MINUTES` to set the timeout
      period. It is also possible to change the idle timeout settings in the SAP system
      using transaction code RZ11, although these changes are temporary and would
      revert upon system restart unless configured permanently.
  known_automation_tools:
  - reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/microsoft-sentinel-and-logic-apps-can-be-the-guardians-of-sap-security/ba-p/13527449
    value: Microsoft Sentinel's SOAR capabilities, utilizing Azure playbooks/Logic
      Apps and an SAP connector, can automate remediation actions like locking SAP
      users by triggering the SAP BAPI Lock function.
  - reference: https://securitybridge.com/solutions/incident-management-and-response/
    value: SecurityBridge offers automated incident response capabilities for SAP,
      including actions like locking compromised user accounts and terminating malicious
      sessions. They also provide SIEM integrations with Microsoft Sentinel and Splunk,
      supporting workflow automation and sharing Indicators of Compromise via APIs.
  - reference: https://www.servicenow.com/community/developer-blog/use-servicenow-to-automate-incident-management-for-sap/ba-p/2675704
    value: ServiceNow can be integrated with SAP S/4HANA for automated incident management.
      This includes creating incidents in ServiceNow from SAP data (using ServiceNow
      ERP Canvas or Import Set API) and triggering SAP S/4HANA work orders from ServiceNow
      service requests.
  - reference: https://www.logpoint.com/en/product/security-for-business-critical-systems/bcs-for-sap/
    value: Logpoint's Converged SIEM Platform is mentioned as a feasible way to integrate
      SAP Systems into a cybersecurity strategy, using SIEM and SOAR tools to automate
      security monitoring.
  - reference: https://www.youtube.com/watch?v=m4P8gSsoCrI
    value: SAP's Situation Handling in S/4HANA Cloud automatically detects business
      issues, notifies relevant experts, and guides them through the resolution process.
      It can be adapted to specific business processes and uses standard situation
      templates.
  revoke_api_key_api:
    reference: https://docs.bmc.com/xwiki/bin/view/IT-Operations-Management/Operations-Management/BMC-TrueSight-Capacity-Optimization/btco2002/Administering/Managing-access-control/Adding-and-managing-roles/Generating-an-API-key-for-programmatic-access/
    value: Uncertain. No specific API or documentation was found regarding the programmatic
      revocation of API keys, personal tokens, or global keys within SAP S/4HANA in
      the search results.
  session_timeout_configuration:
    reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/configuring-the-automatic-sign-out-in-s-4hana-cloud/ba-p/12847077
    value: 'Session timeout for SAP Fiori launchpad in SAP S/4HANA Cloud can be configured
      using two parameters: `SESSION_TIMEOUT_INTERVAL_IN_MINUTES` for UI-driven sign-out
      and `SESSION_TIMEOUT_STOP_DATA_REFRESH` for server-driven sign-out. The default
      server timeout is 30 minutes. If `SESSION_TIMEOUT_INTERVAL_IN_MINUTES` is set
      to -1, automatic sign-out is disabled (this is the default setting). The idle
      timeout in the SAP system can also be changed using transaction code RZ11, with
      a default of 3600 seconds (60 minutes). Changes made via RZ11 are temporary
      unless permanently configured.'
  suspend_user_api:
    reference: https://community.sap.com/t5/enterprise-resource-planning-blog-posts-by-members/microsoft-sentinel-and-logic-apps-can-be-the-guardians-of-sap-security/ba-p/13527449
    value: While no direct "suspend user API" was explicitly found, automated actions
      to lock a compromised user account are possible through SOAR integrations leveraging
      SAP BAPI functions, as demonstrated with Microsoft Sentinel and Azure Logic
      Apps. SecurityBridge also mentions automated actions like "locking a compromised
      user account" as part of their incident response capabilities for SAP.
  user_status_api:
    reference: hallucinated link doublecheck content
    value: An API for "Change Record User Status" is available in SAP Business Accelerator
      Hub, which "reads all change record - user status with its user status text
      in the system." This API is of ODATAV4 type and is active. The general concept
      of "User Status" in SAP also allows for custom configurations to control the
      state of objects.
  user_toggle_api:
    reference: https://community.sap.com/t5/technology-q-a/user-management-api-for-unlocking-locking-users/qaq-p/5481978
    value: While no direct API for toggling user status that explicitly details its
      effect on active sessions was found, the ability to programmatically lock user
      accounts is mentioned in the context of SOAR integrations. The concept of 'User
      Status' exists in SAP S/4HANA, which can be configured to represent the object
      state and provide more control, but its direct programmatic toggling to disable
      active sessions was not explicitly detailed.
